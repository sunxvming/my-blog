<!DOCTYPE HTML><html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>5.hbase</title>
    

<link rel="stylesheet" name="wiz_tmp_editor_style" href="5.hbase_files/fonts_274.css"><style id="wiz_custom_css">html, body {            font-size: 15px;        }        body {            font-family: Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;            line-height: 1.6;            margin: 0;            padding: 20px 15px;            padding: 1.33rem 1rem;        }        h1, h2, h3, h4, h5, h6 {            margin: 20px 0 10px;            margin: 1.33rem 0 0.667rem;            padding: 0;            font-weight: bold;        }        h1 {            font-size: 21px;            font-size: 1.4rem;        }        h2 {            font-size: 20px;            font-size: 1.33rem;        }        h3 {            font-size: 18px;            font-size: 1.2rem;        }        h4 {            font-size: 17px;            font-size: 1.13rem;        }        h5 {            font-size: 15px;            font-size: 1rem;        }        h6 {            font-size: 15px;            font-size: 1rem;            color: #777777;            margin: 1rem 0;        }        div, p, ul, ol, dl, li {            margin: 0;        }        blockquote, table, pre, code {            margin: 8px 0;        }        ul, ol {            padding-left: 32px;            padding-left: 2.13rem;        }        blockquote {            padding: 0 12px;            padding: 0 0.8rem;        }        blockquote > :first-child {            margin-top: 0;        }        blockquote > :last-child {            margin-bottom: 0;        }        img {            border: 0;            max-width: 100%;            height: auto !important;            margin: 2px 0;        }        table {            border-collapse: collapse;            border: 1px solid #bbbbbb;        }        td, th {            padding: 4px 8px;            border-collapse: collapse;            border: 1px solid #bbbbbb;			        }        @media only screen and (-webkit-max-device-width: 1024px), only screen and (-o-max-device-width: 1024px), only screen and (max-device-width: 1024px), only screen and (-webkit-min-device-pixel-ratio: 3), only screen and (-o-min-device-pixel-ratio: 3), only screen and (min-device-pixel-ratio: 3) {            html, body {                font-size: 17px;            }            body {                line-height: 1.7;                padding: 0.75rem 0.9375rem;                color: #353c47;            }            h1 {                font-size: 2.125rem;            }            h2 {                font-size: 1.875rem;            }            h3 {                font-size: 1.625rem;            }            h4 {                font-size: 1.375rem;            }            h5 {                font-size: 1.125rem;            }            h6 {                color: inherit;            }            ul, ol {                padding-left: 2.5rem;            }            blockquote {                padding: 0 0.9375rem;            }        }</style><link rel="stylesheet"  name="wiz_tmp_editor_style" href="5.hbase_files/fonts_275.css"><link type="text/css" rel="stylesheet" id="wiz_code_highlight_link" href="5.hbase_files/wiz_code_highlight_25.css"></head>

<body style="" spellcheck="false" ><div>./hbase shell &nbsp;命令行连接， help会打印出帮助的信息 &nbsp;help 'del' &nbsp; &nbsp;help 'dll'</div><div>hbase的老大是hmaster，小弟是HRegionServer，实现高可用行和分布式存储，HRegion是分布式存储的最小单元</div><div>hbase数据存储结构</div><div><br></div><div>行健--&gt;列族--&gt;列</div><div><img src="5.hbase_files/168837167.png" border="0" name="" width="888" height="468"><div><br></div></div><div>由{row key,column(=&lt;family&gt;+&lt;labe（列的标识符）l&gt;),version}唯一确定一个数据单元</div><h1>【集群的搭建】</h1><div><div>1.上传hbase安装包</div><div><br></div><div>2.解压</div><div><br></div><div>3.配置hbase集群，要修改3个文件（首先zk集群已经安装好了）</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>注意：要把hadoop的hdfs-site.xml和core-site.xml 放到hbase/conf下!!!这样hbase的节点才能知道要连接那个namenode，即映射关系</div><div><span class="Apple-tab-span" style="white-space:pre">	</span></div><div><span class="Apple-tab-span" style="white-space:pre">	</span>3.1修改hbase-env.sh</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>export JAVA_HOME=/usr/java/jdk1.7.0_55</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>//告诉hbase使用外部的zk&nbsp;</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>export HBASE_MANAGES_ZK=false &nbsp;true代表不使用外部的zookeeper</div><div><span class="Apple-tab-span" style="white-space:pre">	</span></div><div><span class="Apple-tab-span" style="white-space:pre">	</span>vim hbase-site.xml</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>&lt;configuration&gt;</div><div><span class="Apple-tab-span" style="white-space:pre">		</span>&lt;!-- 指定hbase在HDFS上存储的路径 --&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &lt;property&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;name&gt;hbase.rootdir&lt;/name&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;value&gt;hdfs://ns1/hbase&lt;/value&gt; &nbsp;nameservice 下的hbase目录</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &lt;/property&gt;</div><div><span class="Apple-tab-span" style="white-space:pre">		</span>&lt;!-- 指定hbase是分布式的 --&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &lt;property&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;name&gt;hbase.cluster.distributed&lt;/name&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;value&gt;true&lt;/value&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &lt;/property&gt;</div><div><span class="Apple-tab-span" style="white-space:pre">		</span>&lt;!-- 指定zk的地址，多个用“,”分割 --&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &lt;property&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;name&gt;hbase.zookeeper.quorum&lt;/name&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;value&gt;itcast04:2181,itcast05:2181,itcast06:2181&lt;/value&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &lt;/property&gt;</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>&lt;/configuration&gt;</div><div><span class="Apple-tab-span" style="white-space:pre">	</span></div><div><span class="Apple-tab-span" style="white-space:pre">	</span>vim regionservers &nbsp;//指定hbase的小弟，相当于hdfs的slave</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>itcast03</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>itcast04</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>itcast05</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>itcast06</div><div><span class="Apple-tab-span" style="white-space:pre">	</span></div><div><span class="Apple-tab-span" style="white-space:pre">	</span>3.2拷贝hbase到其他节点</div><div><span class="Apple-tab-span" style="white-space:pre">		</span>scp -r /itcast/hbase-0.96.2-hadoop2/ itcast02:/itcast/</div><div><span class="Apple-tab-span" style="white-space:pre">		</span>scp -r /itcast/hbase-0.96.2-hadoop2/ itcast03:/itcast/</div><div><span class="Apple-tab-span" style="white-space:pre">		</span>scp -r /itcast/hbase-0.96.2-hadoop2/ itcast04:/itcast/</div><div><span class="Apple-tab-span" style="white-space:pre">		</span>scp -r /itcast/hbase-0.96.2-hadoop2/ itcast05:/itcast/</div><div><span class="Apple-tab-span" style="white-space:pre">		</span>scp -r /itcast/hbase-0.96.2-hadoop2/ itcast06:/itcast/</div><div>4.将配置好的HBase拷贝到每一个节点并同步时间。</div><div><br></div><div>5.启动所有的hbase</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>分别启动zk</div><div><span class="Apple-tab-span" style="white-space:pre">		</span>./zkServer.sh start</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>启动hbase集群</div><div><span class="Apple-tab-span" style="white-space:pre">		</span>start-dfs.sh</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>启动hbase，在主节点上运行：</div><div><span class="Apple-tab-span" style="white-space:pre">		</span>start-hbase.sh</div><div>6.通过浏览器访问hbase管理页面</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>192.168.1.201:60010</div><div>7.为保证集群的可靠性，要启动多个HMaster（起码两个，这样其中一个宕掉了会有其他的替换上）</div><div><span class="Apple-tab-span" style="white-space:pre">	</span>hbase-daemon.sh start master</div><div><span class="Apple-tab-span" style="white-space:pre">	</span></div></div><h1><span style="line-height: 24.2857px;">【hbase shell】</span></h1><div><div><span style="line-height: 24.2857px;">进入hbase命令行</span></div><div><span style="line-height: 24.2857px;">./hbase shell</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">显示hbase中的表</span></div><div><span style="line-height: 24.2857px;">list</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">创建user表，包含info、data两个列族</span></div><div><span style="line-height: 24.2857px;">create 'user', 'info1', 'data1'</span></div><div><span style="line-height: 24.2857px;">create 'user', {NAME =&gt; 'info', VERSIONS =&gt; '3'} &nbsp; //表示这个cell可以存放三个版本的数据，默认是存一份的</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">向user表中插入信息，row key为rk0001，列族info中添加name列标示符，值为zhangsan</span></div><div><span style="line-height: 24.2857px;">put 'user', 'rk0001', 'info:name', 'zhangsan'</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">向user表中插入信息，row key为rk0001，列族info中添加gender列标示符，值为female</span></div><div><span style="line-height: 24.2857px;">put 'user', 'rk0001', 'info:gender', 'female'</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">向user表中插入信息，row key为rk0001，列族info中添加age列标示符，值为20</span></div><div><span style="line-height: 24.2857px;">put 'user', 'rk0001', 'info:age', 20</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">向user表中插入信息，row key为rk0001，列族data中添加pic列标示符，值为picture</span></div><div><span style="line-height: 24.2857px;">put 'user', 'rk0001', 'data:pic', 'picture'</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">获取user表中row key为rk0001的所有信息</span></div><div><span style="line-height: 24.2857px;">get 'user', 'rk0001'</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">获取user表中row key为rk0001，info列族的所有信息</span></div><div><span style="line-height: 24.2857px;">get 'user', 'rk0001', 'info'</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">获取user表中row key为rk0001，info列族的name、age列标示符的信息</span></div><div><span style="line-height: 24.2857px;">get 'user', 'rk0001', 'info:name', 'info:age'</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">获取user表中row key为rk0001，info、data列族的信息</span></div><div><span style="line-height: 24.2857px;">get 'user', 'rk0001', 'info', 'data'</span></div><div><span style="line-height: 24.2857px;">get 'user', 'rk0001', {COLUMN =&gt; ['info', 'data']}</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">get 'user', 'rk0001', {COLUMN =&gt; ['info:name', 'data:pic']}</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">获取user表中row key为rk0001，列族为info，版本号最新5个的信息</span></div><div><span style="line-height: 24.2857px;">get 'people', 'rk0002', {COLUMN =&gt; 'info', VERSIONS =&gt; 2}</span></div><div><span style="line-height: 24.2857px;">get 'user', 'rk0001', {COLUMN =&gt; 'info:name', VERSIONS =&gt; 5}</span></div><div><span style="line-height: 24.2857px;">get 'user', 'rk0001', {COLUMN =&gt; 'info:name', VERSIONS =&gt; 5, TIMERANGE =&gt; [1392368783980, 1392380169184]} &nbsp; 时间戳范围，前闭后开</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">获取user表中row key为rk0001，cell的值为zhangsan的信息</span></div><div><span style="line-height: 24.2857px;">get 'people', 'rk0001', {FILTER =&gt; "ValueFilter(=, 'binary:图片')"}</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">获取user表中row key为rk0001，列标示符中含有a的信息</span></div><div><span style="line-height: 24.2857px;">get 'people', 'rk0001', {FILTER =&gt; "(QualifierFilter(=,'substring:a'))"}</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">put 'user', 'rk0002', 'info:name', 'fanbingbing'</span></div><div><span style="line-height: 24.2857px;">put 'user', 'rk0002', 'info:gender', 'female'</span></div><div><span style="line-height: 24.2857px;">put 'user', 'rk0002', 'info:nationality', '中国'</span></div><div><span style="line-height: 24.2857px;">get 'user', 'rk0002', {FILTER =&gt; "ValueFilter(=, 'binary:中国')"} &nbsp;//二进制值等于中国的取出来</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">查询user表中的所有信息</span></div><div><span style="line-height: 24.2857px;">scan 'user'</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">查询user表中列族为info的信息</span></div><div><span style="line-height: 24.2857px;">scan 'people', {COLUMNS =&gt; 'info'}</span></div><div><span style="line-height: 24.2857px;">scan 'user', {COLUMNS =&gt; 'info', RAW =&gt; true, VERSIONS =&gt; 5}</span></div><div><span style="line-height: 24.2857px;">scan 'persion', {COLUMNS =&gt; 'info', RAW =&gt; true, VERSIONS =&gt; 3}</span></div><div><span style="line-height: 24.2857px;">查询user表中列族为info和data的信息</span></div><div><span style="line-height: 24.2857px;">scan 'user', {COLUMNS =&gt; ['info', 'data']}</span></div><div><span style="line-height: 24.2857px;">scan 'user', {COLUMNS =&gt; ['info:name', 'data:pic']}</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">查询user表中列族为info、列标示符为name的信息</span></div><div><span style="line-height: 24.2857px;">scan 'user', {COLUMNS =&gt; 'info:name'}</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">查询user表中列族为info、列标示符为name的信息,并且版本最新的5个</span></div><div><span style="line-height: 24.2857px;">scan 'user', {COLUMNS =&gt; 'info:name', VERSIONS =&gt; 5}</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">查询user表中列族为info和data且列标示符中含有a字符的信息</span></div><div><span style="line-height: 24.2857px;">scan 'people', {COLUMNS =&gt; ['info', 'data'], FILTER =&gt; "(QualifierFilter(=,'substring:a'))"}</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">查询user表中列族为info，rk范围是[rk0001, rk0003)的数据</span></div><div><span style="line-height: 24.2857px;">scan 'people', {COLUMNS =&gt; 'info', STARTROW =&gt; 'rk0001', ENDROW =&gt; 'rk0003'}</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">查询user表中row key以rk字符开头的</span></div><div><span style="line-height: 24.2857px;">scan 'user',{FILTER=&gt;"PrefixFilter('rk')"}</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">查询user表中指定范围的数据</span></div><div><span style="line-height: 24.2857px;">scan 'user', {TIMERANGE =&gt; [1392368783980, 1392380169184]}</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">删除数据</span></div><div><span style="line-height: 24.2857px;">删除user表row key为rk0001，列标示符为info:name的数据</span></div><div><span style="line-height: 24.2857px;">delete 'people', 'rk0001', 'info:name'</span></div><div><span style="line-height: 24.2857px;">删除user表row key为rk0001，列标示符为info:name，timestamp为1392383705316的数据</span></div><div><span style="line-height: 24.2857px;">delete 'user', 'rk0001', 'info:name', 1392383705316</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">清空user表中的数据</span></div><div><span style="line-height: 24.2857px;">truncate 'people'</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">修改表结构</span></div><div><span style="line-height: 24.2857px;">首先停用user表（新版本不用）</span></div><div><span style="line-height: 24.2857px;">disable 'user'</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">添加两个列族f1和f2</span></div><div><span style="line-height: 24.2857px;">alter 'people', NAME =&gt; 'f1'</span></div><div><span style="line-height: 24.2857px;">alter 'user', NAME =&gt; 'f2'</span></div><div><span style="line-height: 24.2857px;">启用表</span></div><div><span style="line-height: 24.2857px;">enable 'user'</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">###disable 'user'(新版本不用)</span></div><div><span style="line-height: 24.2857px;">删除一个列族：</span></div><div><span style="line-height: 24.2857px;">alter 'user', NAME =&gt; 'f1', METHOD =&gt; 'delete' 或 alter 'user', 'delete' =&gt; 'f1'</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">添加列族f1同时删除列族f2</span></div><div><span style="line-height: 24.2857px;">alter 'user', {NAME =&gt; 'f1'}, {NAME =&gt; 'f2', METHOD =&gt; 'delete'}</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">将user表的f1列族版本号改为5</span></div><div><span style="line-height: 24.2857px;">alter 'people', NAME =&gt; 'info', VERSIONS =&gt; 5</span></div><div><span style="line-height: 24.2857px;">启用表</span></div><div><span style="line-height: 24.2857px;">enable 'user'</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">删除表</span></div><div><span style="line-height: 24.2857px;">disable 'user'</span></div><div><span style="line-height: 24.2857px;">drop 'user'</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">get 'person', 'rk0001', {FILTER =&gt; "ValueFilter(=, 'binary:中国')"}</span></div><div><span style="line-height: 24.2857px;">get 'person', 'rk0001', {FILTER =&gt; "(QualifierFilter(=,'substring:a'))"}</span></div><div><span style="line-height: 24.2857px;">scan 'person', {COLUMNS =&gt; 'info:name'}</span></div><div><span style="line-height: 24.2857px;">scan 'person', {COLUMNS =&gt; ['info', 'data'], FILTER =&gt; "(QualifierFilter(=,'substring:a'))"}</span></div><div><span style="line-height: 24.2857px;">scan 'person', {COLUMNS =&gt; 'info', STARTROW =&gt; 'rk0001', ENDROW =&gt; 'rk0003'}</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">scan 'person', {COLUMNS =&gt; 'info', STARTROW =&gt; '20140201', ENDROW =&gt; '20140301'}</span></div><div><span style="line-height: 24.2857px;">scan 'person', {COLUMNS =&gt; 'info:name', TIMERANGE =&gt; [1395978233636, 1395987769587]}</span></div><div><span style="line-height: 24.2857px;">delete 'person', 'rk0001', 'info:name'</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">alter 'person', NAME =&gt; 'ffff'</span></div><div><span style="line-height: 24.2857px;">alter 'person', NAME =&gt; 'info', VERSIONS =&gt; 10</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">get 'user', 'rk0002', {COLUMN =&gt; ['info:name', 'data:pic']}</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><span style="line-height: 24.2857px;">scan 'people', {COLUMNS =&gt; 'info',RAW =&gt; true, VERSIONS =&gt; 3}</span></div><div><span style="line-height: 24.2857px;"><br></span></div><div><div><div><pre class="prettyprint linenums prettyprinted"><ol class="linenums"><li class="L0"><code class="language-java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">HbaseDemo</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L1"><code class="language-java"></code></li><li class="L2"><code class="language-java"><span class="pln">	</span><span class="kwd">private</span><span class="pln"> </span><span class="typ">Configuration</span><span class="pln"> conf </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span></code></li><li class="L3"><code class="language-java"><span class="pln">	</span></code></li><li class="L4"><code class="language-java"><span class="pln">	</span><span class="lit">@Before</span></code></li><li class="L5"><code class="language-java"><span class="pln">	</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> init</span><span class="pun">(){</span></code></li><li class="L6"><code class="language-java"><span class="pln">		conf </span><span class="pun">=</span><span class="pln"> </span><span class="typ">HBaseConfiguration</span><span class="pun">.</span><span class="pln">create</span><span class="pun">();</span></code></li><li class="L7"><code class="language-java"><span class="pln">		conf</span><span class="pun">.</span><span class="pln">set</span><span class="pun">(</span><span class="str">"hbase.zookeeper.quorum"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"hadoop01,hadoop02,hadoop03"</span><span class="pun">);</span></code></li><li class="L8"><code class="language-java"><span class="pln">	</span><span class="pun">}</span></code></li><li class="L9"><code class="language-java"><span class="pln">	</span></code></li><li class="L0"><code class="language-java"><span class="pln">	</span><span class="lit">@Test</span></code></li><li class="L1"><code class="language-java"><span class="pln">	</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> testDrop</span><span class="pun">()</span><span class="pln"> </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">Exception</span><span class="pun">{</span></code></li><li class="L2"><code class="language-java"><span class="pln">		</span><span class="typ">HBaseAdmin</span><span class="pln"> admin </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">HBaseAdmin</span><span class="pun">(</span><span class="pln">conf</span><span class="pun">);</span></code></li><li class="L3"><code class="language-java"><span class="pln">		admin</span><span class="pun">.</span><span class="pln">disableTable</span><span class="pun">(</span><span class="str">"account"</span><span class="pun">);</span></code></li><li class="L4"><code class="language-java"><span class="pln">		admin</span><span class="pun">.</span><span class="pln">deleteTable</span><span class="pun">(</span><span class="str">"account"</span><span class="pun">);</span></code></li><li class="L5"><code class="language-java"><span class="pln">		admin</span><span class="pun">.</span><span class="pln">close</span><span class="pun">();</span></code></li><li class="L6"><code class="language-java"><span class="pln">	</span><span class="pun">}</span></code></li><li class="L7"><code class="language-java"><span class="pln">	</span></code></li><li class="L8"><code class="language-java"><span class="pln">	</span><span class="lit">@Test</span></code></li><li class="L9"><code class="language-java"><span class="pln">	</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> testPut</span><span class="pun">()</span><span class="pln"> </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">Exception</span><span class="pun">{</span></code></li><li class="L0"><code class="language-java"><span class="pln">		</span><span class="typ">HTable</span><span class="pln"> table </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">HTable</span><span class="pun">(</span><span class="pln">conf</span><span class="pun">,</span><span class="pln"> </span><span class="str">"user"</span><span class="pun">);</span></code></li><li class="L1"><code class="language-java"><span class="pln">		</span><span class="typ">Put</span><span class="pln"> put </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Put</span><span class="pun">(</span><span class="typ">Bytes</span><span class="pun">.</span><span class="pln">toBytes</span><span class="pun">(</span><span class="str">"rk0003"</span><span class="pun">));</span></code></li><li class="L2"><code class="language-java"><span class="pln">		put</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="typ">Bytes</span><span class="pun">.</span><span class="pln">toBytes</span><span class="pun">(</span><span class="str">"info"</span><span class="pun">),</span><span class="pln"> </span><span class="typ">Bytes</span><span class="pun">.</span><span class="pln">toBytes</span><span class="pun">(</span><span class="str">"name"</span><span class="pun">),</span><span class="pln"> </span><span class="typ">Bytes</span><span class="pun">.</span><span class="pln">toBytes</span><span class="pun">(</span><span class="str">"liuyan"</span><span class="pun">));</span></code></li><li class="L3"><code class="language-java"><span class="pln">		table</span><span class="pun">.</span><span class="pln">put</span><span class="pun">(</span><span class="pln">put</span><span class="pun">);</span></code></li><li class="L4"><code class="language-java"><span class="pln">		table</span><span class="pun">.</span><span class="pln">close</span><span class="pun">();</span></code></li><li class="L5"><code class="language-java"><span class="pln">	</span><span class="pun">}</span></code></li><li class="L6"><code class="language-java"><span class="pln">	</span></code></li><li class="L7"><code class="language-java"><span class="pln">	</span><span class="lit">@Test</span></code></li><li class="L8"><code class="language-java"><span class="pln">	</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> testGet</span><span class="pun">()</span><span class="pln"> </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">Exception</span><span class="pun">{</span></code></li><li class="L9"><code class="language-java"><span class="pln">		</span><span class="com">//HTablePool pool = new HTablePool(conf, 10);</span></code></li><li class="L0"><code class="language-java"><span class="pln">		</span><span class="com">//HTable table = (HTable) pool.getTable("user");</span></code></li><li class="L1"><code class="language-java"><span class="pln">		</span><span class="typ">HTable</span><span class="pln"> table </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">HTable</span><span class="pun">(</span><span class="pln">conf</span><span class="pun">,</span><span class="pln"> </span><span class="str">"user"</span><span class="pun">);</span></code></li><li class="L2"><code class="language-java"><span class="pln">		</span><span class="typ">Get</span><span class="pln"> get </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Get</span><span class="pun">(</span><span class="typ">Bytes</span><span class="pun">.</span><span class="pln">toBytes</span><span class="pun">(</span><span class="str">"rk0001"</span><span class="pun">));</span></code></li><li class="L3"><code class="language-java"><span class="pln">		</span><span class="com">//get.addColumn(Bytes.toBytes("info"), Bytes.toBytes("name"));</span></code></li><li class="L4"><code class="language-java"><span class="pln">		get</span><span class="pun">.</span><span class="pln">setMaxVersions</span><span class="pun">(</span><span class="lit">5</span><span class="pun">);</span></code></li><li class="L5"><code class="language-java"><span class="pln">		</span><span class="typ">Result</span><span class="pln"> result </span><span class="pun">=</span><span class="pln"> table</span><span class="pun">.</span><span class="pln">get</span><span class="pun">(</span><span class="pln">get</span><span class="pun">);</span></code></li><li class="L6"><code class="language-java"><span class="pln">		</span><span class="com">//result.getValue(family, qualifier)</span></code></li><li class="L7"><code class="language-java"><span class="pln">		</span><span class="kwd">for</span><span class="pun">(</span><span class="typ">KeyValue</span><span class="pln"> kv </span><span class="pun">:</span><span class="pln"> result</span><span class="pun">.</span><span class="pln">list</span><span class="pun">()){</span></code></li><li class="L8"><code class="language-java"><span class="pln">			</span><span class="typ">String</span><span class="pln"> family </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">String</span><span class="pun">(</span><span class="pln">kv</span><span class="pun">.</span><span class="pln">getFamily</span><span class="pun">());</span></code></li><li class="L9"><code class="language-java"><span class="pln">			</span><span class="typ">System</span><span class="pun">.</span><span class="pln">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">family</span><span class="pun">);</span></code></li><li class="L0"><code class="language-java"><span class="pln">			</span><span class="typ">String</span><span class="pln"> qualifier </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">String</span><span class="pun">(</span><span class="pln">kv</span><span class="pun">.</span><span class="pln">getQualifier</span><span class="pun">());</span></code></li><li class="L1"><code class="language-java"><span class="pln">			</span><span class="typ">System</span><span class="pun">.</span><span class="pln">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">qualifier</span><span class="pun">);</span></code></li><li class="L2"><code class="language-java"><span class="pln">			</span><span class="typ">System</span><span class="pun">.</span><span class="pln">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">String</span><span class="pun">(</span><span class="pln">kv</span><span class="pun">.</span><span class="pln">getValue</span><span class="pun">()));</span></code></li><li class="L3"><code class="language-java"><span class="pln">		</span><span class="pun">}</span></code></li><li class="L4"><code class="language-java"><span class="pln">		table</span><span class="pun">.</span><span class="pln">close</span><span class="pun">();</span></code></li><li class="L5"><code class="language-java"><span class="pln">	</span><span class="pun">}</span></code></li><li class="L6"><code class="language-java"><span class="pln">	</span></code></li><li class="L7"><code class="language-java"><span class="pln">	</span><span class="lit">@Test</span></code></li><li class="L8"><code class="language-java"><span class="pln">	</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> testScan</span><span class="pun">()</span><span class="pln"> </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">Exception</span><span class="pun">{</span></code></li><li class="L9"><code class="language-java"><span class="pln">		</span><span class="typ">HTablePool</span><span class="pln"> pool </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">HTablePool</span><span class="pun">(</span><span class="pln">conf</span><span class="pun">,</span><span class="pln"> </span><span class="lit">10</span><span class="pun">);</span></code></li><li class="L0"><code class="language-java"><span class="pln">		</span><span class="typ">HTableInterface</span><span class="pln"> table </span><span class="pun">=</span><span class="pln"> pool</span><span class="pun">.</span><span class="pln">getTable</span><span class="pun">(</span><span class="str">"user"</span><span class="pun">);</span></code></li><li class="L1"><code class="language-java"><span class="pln">		</span><span class="typ">Scan</span><span class="pln"> scan </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Scan</span><span class="pun">(</span><span class="typ">Bytes</span><span class="pun">.</span><span class="pln">toBytes</span><span class="pun">(</span><span class="str">"rk0001"</span><span class="pun">),</span><span class="pln"> </span><span class="typ">Bytes</span><span class="pun">.</span><span class="pln">toBytes</span><span class="pun">(</span><span class="str">"rk0002"</span><span class="pun">));</span></code></li><li class="L2"><code class="language-java"><span class="pln">		scan</span><span class="pun">.</span><span class="pln">addFamily</span><span class="pun">(</span><span class="typ">Bytes</span><span class="pun">.</span><span class="pln">toBytes</span><span class="pun">(</span><span class="str">"info"</span><span class="pun">));</span></code></li><li class="L3"><code class="language-java"><span class="pln">		</span><span class="typ">ResultScanner</span><span class="pln"> scanner </span><span class="pun">=</span><span class="pln"> table</span><span class="pun">.</span><span class="pln">getScanner</span><span class="pun">(</span><span class="pln">scan</span><span class="pun">);</span></code></li><li class="L4"><code class="language-java"><span class="pln">		</span><span class="kwd">for</span><span class="pun">(</span><span class="typ">Result</span><span class="pln"> r </span><span class="pun">:</span><span class="pln"> scanner</span><span class="pun">){</span></code></li><li class="L5"><code class="language-java"><span class="pln">			</span><span class="com">/**</span></code></li><li class="L6"><code class="language-java"><span class="com">			for(KeyValue kv : r.list()){</span></code></li><li class="L7"><code class="language-java"><span class="com">				String family = new String(kv.getFamily());</span></code></li><li class="L8"><code class="language-java"><span class="com">				System.out.println(family);</span></code></li><li class="L9"><code class="language-java"><span class="com">				String qualifier = new String(kv.getQualifier());</span></code></li><li class="L0"><code class="language-java"><span class="com">				System.out.println(qualifier);</span></code></li><li class="L1"><code class="language-java"><span class="com">				System.out.println(new String(kv.getValue()));</span></code></li><li class="L2"><code class="language-java"><span class="com">			}</span></code></li><li class="L3"><code class="language-java"><span class="com">			*/</span></code></li><li class="L4"><code class="language-java"><span class="pln">			</span><span class="kwd">byte</span><span class="pun">[]</span><span class="pln"> value </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">.</span><span class="pln">getValue</span><span class="pun">(</span><span class="typ">Bytes</span><span class="pun">.</span><span class="pln">toBytes</span><span class="pun">(</span><span class="str">"info"</span><span class="pun">),</span><span class="pln"> </span><span class="typ">Bytes</span><span class="pun">.</span><span class="pln">toBytes</span><span class="pun">(</span><span class="str">"name"</span><span class="pun">));</span></code></li><li class="L5"><code class="language-java"><span class="pln">			</span><span class="typ">System</span><span class="pun">.</span><span class="pln">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">String</span><span class="pun">(</span><span class="pln">value</span><span class="pun">));</span></code></li><li class="L6"><code class="language-java"><span class="pln">		</span><span class="pun">}</span></code></li><li class="L7"><code class="language-java"><span class="pln">		pool</span><span class="pun">.</span><span class="pln">close</span><span class="pun">();</span></code></li><li class="L8"><code class="language-java"><span class="pln">	</span><span class="pun">}</span></code></li><li class="L9"><code class="language-java"><span class="pln">	</span></code></li><li class="L0"><code class="language-java"><span class="pln">	</span></code></li><li class="L1"><code class="language-java"><span class="pln">	</span><span class="lit">@Test</span></code></li><li class="L2"><code class="language-java"><span class="pln">	</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> testDel</span><span class="pun">()</span><span class="pln"> </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">Exception</span><span class="pun">{</span></code></li><li class="L3"><code class="language-java"><span class="pln">		</span><span class="typ">HTable</span><span class="pln"> table </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">HTable</span><span class="pun">(</span><span class="pln">conf</span><span class="pun">,</span><span class="pln"> </span><span class="str">"user"</span><span class="pun">);</span></code></li><li class="L4"><code class="language-java"><span class="pln">		</span><span class="typ">Delete</span><span class="pln"> del </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Delete</span><span class="pun">(</span><span class="typ">Bytes</span><span class="pun">.</span><span class="pln">toBytes</span><span class="pun">(</span><span class="str">"rk0001"</span><span class="pun">));</span></code></li><li class="L5"><code class="language-java"><span class="pln">		del</span><span class="pun">.</span><span class="pln">deleteColumn</span><span class="pun">(</span><span class="typ">Bytes</span><span class="pun">.</span><span class="pln">toBytes</span><span class="pun">(</span><span class="str">"data"</span><span class="pun">),</span><span class="pln"> </span><span class="typ">Bytes</span><span class="pun">.</span><span class="pln">toBytes</span><span class="pun">(</span><span class="str">"pic"</span><span class="pun">));</span></code></li><li class="L6"><code class="language-java"><span class="pln">		table</span><span class="pun">.</span><span class="kwd">delete</span><span class="pun">(</span><span class="pln">del</span><span class="pun">);</span></code></li><li class="L7"><code class="language-java"><span class="pln">		table</span><span class="pun">.</span><span class="pln">close</span><span class="pun">();</span></code></li><li class="L8"><code class="language-java"><span class="pln">	</span><span class="pun">}</span></code></li><li class="L9"><code class="language-java"><span class="pln">	</span></code></li><li class="L0"><code class="language-java"><span class="pln">	</span></code></li><li class="L1"><code class="language-java"><span class="pln">	</span></code></li><li class="L2"><code class="language-java"><span class="pln">	</span></code></li><li class="L3"><code class="language-java"><span class="pln">	</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">Exception</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L4"><code class="language-java"><span class="pln">		</span><span class="typ">Configuration</span><span class="pln"> conf </span><span class="pun">=</span><span class="pln"> </span><span class="typ">HBaseConfiguration</span><span class="pun">.</span><span class="pln">create</span><span class="pun">();</span></code></li><li class="L5"><code class="language-java"><span class="pln">		conf</span><span class="pun">.</span><span class="pln">set</span><span class="pun">(</span><span class="str">"hbase.zookeeper.quorum"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"hadoop01,hadoop02,hadoop03"</span><span class="pun">);</span></code></li><li class="L6"><code class="language-java"><span class="pln">		</span><span class="typ">HBaseAdmin</span><span class="pln"> admin </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">HBaseAdmin</span><span class="pun">(</span><span class="pln">conf</span><span class="pun">);</span></code></li><li class="L7"><code class="language-java"><span class="pln">		</span><span class="typ">HTableDescriptor</span><span class="pln"> td </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">HTableDescriptor</span><span class="pun">(</span><span class="str">"account"</span><span class="pun">);</span></code></li><li class="L8"><code class="language-java"><span class="pln">		</span><span class="typ">HColumnDescriptor</span><span class="pln"> cd </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">HColumnDescriptor</span><span class="pun">(</span><span class="str">"info"</span><span class="pun">);</span></code></li><li class="L9"><code class="language-java"><span class="pln">		cd</span><span class="pun">.</span><span class="pln">setMaxVersions</span><span class="pun">(</span><span class="lit">10</span><span class="pun">);</span></code></li><li class="L0"><code class="language-java"><span class="pln">		td</span><span class="pun">.</span><span class="pln">addFamily</span><span class="pun">(</span><span class="pln">cd</span><span class="pun">);</span></code></li><li class="L1"><code class="language-java"><span class="pln">		admin</span><span class="pun">.</span><span class="pln">createTable</span><span class="pun">(</span><span class="pln">td</span><span class="pun">);</span></code></li><li class="L2"><code class="language-java"><span class="pln">		admin</span><span class="pun">.</span><span class="pln">close</span><span class="pun">();</span></code></li><li class="L3"><code class="language-java"></code></li><li class="L4"><code class="language-java"><span class="pln">	</span><span class="pun">}</span></code></li><li class="L5"><code class="language-java"><span class="pln">	</span></code></li><li class="L6"><code class="language-java"><span class="pln">	</span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> createTable</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> tableName</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> maxVersion</span><span class="pun">,</span><span class="pln"> </span><span class="typ">String</span><span class="pun">...</span><span class="pln"> cf</span><span class="pun">){</span></code></li><li class="L7"><code class="language-java"><span class="pln">		</span></code></li><li class="L8"><code class="language-java"><span class="pln">	</span><span class="pun">}</span></code></li><li class="L9"><code class="language-java"></code></li><li class="L0"><code class="language-java"><span class="pun">}</span></code></li></ol></pre></div><div><br></div></div><div style="line-height: 24.2857px;"><br></div></div><div style="line-height: 24.2857px;"><br></div></div><h1>【pig笔记】</h1><div>但Hive还似乎有点数据库的影子，而Pig基本就是一个对MapReduce实现的工具(脚本)<br></div><div><div>Language&nbsp; </div><div>在Hive中可以执行&nbsp; 插入/删除 等操作，但是Pig中我没有发现有可以 插入 数据的方法，请允许我暂且认为这是最大的不同点吧。&nbsp; </div><div>Schemas&nbsp; </div><div>Hive中至少还有一个“表”的概念，但是Pig中我认为是基本没有表的概念，所谓的表建立在Pig Latin脚本中，对与Pig更不要提metadata了。&nbsp; </div><div>Partitions&nbsp; </div><div>Pig中没有表的概念，所以说到分区对于Pig来说基本免谈，如果跟Hive说“分区”(Partition)他还是能明白的。&nbsp; </div><div>Server&nbsp; </div><div>Hive可以依托于Thrift启动一个服务器，提供远程调用。 找了半天压根没有发现Pig有这样的功能，如果你有新发现可以告诉我，就好像有人开发了一个Hive的REST&nbsp; </div><div>Shell&nbsp; </div><div>在Pig 你可以执行一些个 ls 、cat 这样很经典、很cool的命令，但是在使用Hive的时候我压根就没有想过有这样的需求。&nbsp; </div><div>Web Interface&nbsp; </div><div>Hive有，Pig无&nbsp; </div><div>JDBC/ODBC&nbsp;</div><div>Pig无，Hive有</div></div><div><br></div><div><br></div><div><div>1.安装Pig</div><div>&nbsp;&nbsp;&nbsp; 将pig添加到环境变量当中</div><div>&nbsp;</div><div>2.pig使用</div><div>&nbsp;&nbsp;&nbsp; 首先将数据库中的数据导入到HDFS上，两者都拥有自己的表达语言，其目的是将MapReduce的实现进行简化，并且读写操作数据最终都是存储在HDFS分布式文件系统上</div><div>&nbsp;&nbsp;&nbsp; sqoop import --connect jdbc:mysql://192.168.1.10:3306/itcast --username root --password 123&nbsp; --table trade_detail --target-dir '/sqoop/td'</div><div>&nbsp;&nbsp;&nbsp; sqoop import --connect jdbc:mysql://192.168.1.10:3306/itcast --username root --password 123&nbsp; --table user_info --target-dir '/sqoop/ui'</div><div>&nbsp;</div><div>&nbsp;</div><div>&nbsp;&nbsp;&nbsp; td = load '/sqoop/td' using PigStorage(',') as (id:long, account:chararray, income:double, expenses:double, time:chararray);</div><div>&nbsp;&nbsp;&nbsp; ui = load '/sqoop/ui' using PigStorage(',') as (id:long, account:chararray, name:chararray, age:int);</div><div>&nbsp;</div><div>&nbsp;&nbsp;&nbsp; td1 = foreach td generate account, income, expenses, income-expenses as surplus;</div><div>&nbsp;</div><div>&nbsp;&nbsp;&nbsp; td2 = group td1 by account;</div><div>&nbsp;</div><div>&nbsp;&nbsp;&nbsp; td3 = foreach td2 generate group as account, SUM(td1.income) as income, SUM(td1.expenses) as expenses, SUM(td1.surplus) as surplus;</div><div>&nbsp;</div><div>&nbsp;&nbsp;&nbsp; tu = join td3 by account, ui by account;</div><div>&nbsp;</div><div>&nbsp;&nbsp;&nbsp; result = foreach tu generate td3::account as account, ui::name, td3::income, td3::expenses, td3::surplus;</div><div>&nbsp;</div><div>&nbsp;&nbsp;&nbsp; store result into '/result' using PigStorage(',');</div></div><div><span style="line-height: 24.2857px;"><br></span></div></body></html>