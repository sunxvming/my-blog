<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta name="generator" content="pandoc" />




<link rel="stylesheet" href="../../../.././css/style.css" />




<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Saira+Semi+Condensed%3A400%2C700&ver=4.9.18" type="text/css" />

<script src="https://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
<script>
jQuery(document).ready(function(){
    jQuery('pre').each(function(){
        var el = jQuery(this).find('code');
        var code_block = el.html(); 
 
        if (el.length > 0) { 
            jQuery(this).addClass('prettyprint').html(code_block).attr('style', 'max-height:450px');
        } else { 
            jQuery(this).removeClass().addClass('prettyprint'); 
        }
    });
});
</script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js?skin=desert"></script>

</head>


<body>
<div id="wrapper">


<style type="text/css">

#masthead .site-branding {
    margin-bottom: 7px;
}

#masthead .site-branding .site-title {
    font-size: 2.2rem;
    line-height: 1;
    text-transform: uppercase;
    margin: 0;
    margin-bottom: 0.5rem;
}


#masthead .site-description{
	margin:0px;
}




#masthead .site-branding .site-title a {
    display: inline-block;
    position: relative;
    top: -11px;
}

#masthead  a {
    <!-- color: #007bff; -->
    text-decoration: none;
    background-color: transparent;
}



.io-menu-desktop {
    display: block;
    text-align: right;
}
.io-menu-desktop span.io-menu-button-span {
    display: none;
}
.io-menu-desktop ul {
    padding: 0;
    margin: 0;
    list-style: none;
    background: transparent;
    display: block;
}
.io-menu-desktop ul > li {
    margin-right: -4px;
    display: inline-block;
    position: relative;
    height: 30px;
    color: #212529;
    font-size: 12px;
    text-transform: uppercase;
    text-shadow: 0 0 0 rgb(0 0 0 / 0%);
    font-weight: 400;
}
.io-menu-desktop ul > li > a {
    padding: 0;
    line-height: 29px;
    padding-left: 20px;
    padding-right: 20px;
    padding-top: 1px;
    color: #212529;
    font-size: 12px;
    text-transform: uppercase;
    text-shadow: 0 0 0 rgb(0 0 0 / 0%);
    font-weight: 400;
}
.io-menu-desktop a {
    display: block;
    -o-transition: none;
    -moz-transition: none;
    -webkit-transition: none;
    transition: none;
}
.io-menu-desktop > ul > li.current-menu-item > a, .io-menu-desktop > div > ul > li.current-menu-item > a {
    background: rgba(0, 0, 0, 0.01);
}



#colophon {
    margin-top: 70px;
    margin-bottom: 30px;
}
#colophon .site-info {
    text-align: center;
}

</style>


<header id="masthead" class="site-header row">
    <div class="site-branding col-sm-6">
        <span class="site-title" style="font-size: 2.2rem">
            <span>
                <img width="60px" height="60px"
                    src="http://www.sunxvming.com/imgs/QQ图片20191023170517.jpg">
            </span>


            <a href="http://www.sunxvming.com/" rel="home">忧郁的大能猫</a>
        </span>
        <p class="site-description">好奇的探索者，理性的思考者，踏实的行动者。</p>
    </div><!-- .site-branding -->

    <nav id="site-navigation" class="main-navigation col-sm-9">
        <div class="io-menu io-menu-desktop"><span class="io-menu-button io-menu-button-span">≡</span>

            <div class="menu-%e4%b8%bb%e8%8f%9c%e5%8d%95-container">
                <ul id="primary-menu" class="menu">
                    <li id="menu-item-38"
                        class="menu-item menu-item-type-custom menu-item-object-custom current-menu-item current_page_item menu-item-home menu-item-38">
                        <a href="http://www.sunxvming.com">首页</a></li>
                    <li id="menu-item-175"
                        class="menu-item menu-item-type-post_type menu-item-object-page menu-item-175"><a
                            href="http://www.sunxvming.com/">所有文章</a></li>
                    <li id="menu-item-176"
                        class="menu-item menu-item-type-post_type menu-item-object-page menu-item-176"><a
                            href="http://www.sunxvming.com/blog/about-me.html">关于俺</a></li>
                </ul>
            </div>
        </div><!-- .io-menu -->
    </nav><!-- #site-navigation -->
</header>

<div id="header">
<h1 class="title">blog/IT/40-tools/版本管理/git命令</h1>
</div> <!--id="header"-->
 <!--if(title)-->

<p>Table of Contents:</p>
<div id="TOC">
<ul>
<li><a href="#执行命令将debug_dofile.lua加入不提交队列">执行命令将debug_dofile.lua加入不提交队列</a></li>
<li><a href="#执行命令将debug_dofile.lua取消加入不提交队列">执行命令将debug_dofile.lua取消加入不提交队列</a></li>
</ul>
</div>
 <!--if(toc)-->

<p>【github太慢】</p>
<ol>
<li>使用github的镜像网站进行访问，github.com.cnpmjs.org，将github.com替换成github.com.cnpmjs.org，之后的各种操作都一样</li>
<li>“码云极速下载” 是为了提升国内下载速度的镜像仓库，每日同步一次。 https://gitee.com/mirrors<br />
【资源】</li>
</ol>
<p>git简明指南 https://rogerdudler.github.io/git-guide/index.zh.html<br />
廖雪峰git教程 http://www.liaoxuefeng.com/<br />
git教程博客 https://www.jianshu.com/p/9685a56bdf7a</p>
<p>【图形化界面工具】<br />
git图形化界面Sourcetree</p>
<p>【三个区】<br />
你的本地仓库由 git 维护的三棵“树”组成。<br />
1. 工作目录(工作区)，它持有实际文件<br />
2. 缓存区（Index），它像个缓存区域，临时保存你的改动<br />
3. 最后是 HEAD，指向你最近一次提交后的结果。<br />
工作区 -- add--&gt; Index(暂存区) --commit--&gt; HEAD</p>
<p>【linux设置密码】<br />
git config --global credential.helper 'cache --timeout=3600000'</p>
<p>【基本】<br />
查看git配置信息：git config --list<br />
查看用户名：git config user.name<br />
查看邮箱：git config user.email</p>
<p>生成密钥对<br />
ssh-keygen -t rsa -C "sunxvming@gmail.com"<br />
git config --global user.name "sunxvming"<br />
git config --global user.email sunxvming@gmail.com</p>
<p>克隆远程仓库 git clone xxx</p>
<p>初始化仓库 git init<br />
提交到缓存区 git add *<br />
git add -A The -A option is shorthand for --all.<br />
this command will stage all files in your repository, which includes all new, modified, and deleted files.</p>
<p>删除文件 git rm <filename><br />
误删恢复 git checkout -- test.txt</p>
<p>提交到head区 git commit -m "note"</p>
<p>查看工作区状态 git status<br />
从最近到最远的提交日志 git log<br />
查看某个提交号的内容 git show <ID><br />
查看命令历史 git reflog 可以查看提交的版本号</p>
<p>查看文件的提交记录 git blame aa.txt<br />
查看工作区和版本库里面最新版本的区别 git diff HEAD -- readme.txt</p>
<p>【revert】<br />
回退上一次提交 git reset --hard HEAD^ ^^上两个 HEAD~100 上100个<br />
回退指定版本(指定提交号) git reset --hard 3628164<br />
丢弃工作区的指定文件 git checkout -- <file> --符号不能少<br />
丢弃工作区的所有文件 git checkout .<br />
把暂存区的修改撤销掉，重新放回工作区 git reset HEAD readme.txt</p>
<p>删除当前目录下所有没有track过的文件. 它不会删除 .gitignore 文件里指定的文件夹和文件, 不管这些文件有没有被track过<br />
git clean -fd</p>
<p>删除源 git remote rm origin<br />
添加源 git remote add origin https://github.com/sunxvming/onethink.git<br />
远程库的名字就是origin，这是Git默认的叫法，也可以改成别的，但是origin这个名字一看就知道是远程库。<br />
推送代码 git push origin master -----&gt;以后直接git push就行，默认push到master</p>
<p>【分支】<br />
创建分支 git branch xx<br />
切换分支 git checkout xx<br />
创建并切换 git checkout -b xx(git checkout -b 9day origin/9day_20190702)<br />
查看所有分支 git branch -a 当前分支表有*号标记<br />
查看远程的分支 git branch -r<br />
把本地分支推送到远端分支(远端的分支可以是不存在的) git push origin txboardcast<br />
合并指定分支到当前分支 git merge xx<br />
冲突后丢弃 git merge --abort<br />
查看两个分支的diff git diff branch1 branch2<br />
删除分支 git branch -d xx</p>
<p><img src="https://sxm-upload.oss-cn-beijing.aliyuncs.com/imgs/5c211a2a-e278-4cb5-8122-19b387d8904c.png" />Fast-forward快速的合并方式，就是指针变几下就行</p>
<p>因为创建、合并和删除分支非常快，所以Git鼓励你使用分支完成某个任务，合并后再删掉分支，<br />
这和直接在master分支上工作效果是一样的，但过程更安全。</p>
<p><img src="https://sxm-upload.oss-cn-beijing.aliyuncs.com/imgs/7ce6acac-6082-4746-b297-4abc1fe309bb.png" />两个文件都被修改了</p>
<p>这种情况下，Git无法执行“快速合并”，只能试图把各自的修改合并起来，但这种合并就可能会有冲突</p>
<p>git status也可以告诉我们冲突的文件</p>
<p>【标签】<br />
标签也是版本库的一个快照。它是指向某个commit的指针（跟分支很像对不对？但是分支可以移动，标签不能移动），创建和删除标 签都是瞬间完成<br />
切换到需要打标签的分支上，打的标签默认是在最新一次的commit上打的,就是HEAD指向的位置: git tag v1.0<br />
指定的版本上打标签 ：git tag v0.9 <提交号><br />
查看标签 ：git tag<br />
查看标签信息 ：git show <tagname><br />
还可以创建带有说明的标签，用-a指定标签名，-m指定说明文字：<br />
$ git tag -a v0.1 -m "version 0.1 released" 3628164<br />
删除标签 ：git tag -d v0.1</p>
<p>git push的时候默认不推送tag的，若推送的话可以用下面的命令<br />
git push --tags<br />
git push origin --tags<br />
git checkout tagname 切换tag</p>
<p>【git rebase】<br />
第二种合并分支的方法是 git rebase</p>
<p>Rebase 实际上就是取出一系列的提交记录，“复制”它们，然后在此基础上把此分支的提交记录扔上去</p>
<p>Rebase 的优势就是可以创造更线性的提交历史</p>
<p>比如：想把bugFix分支里的工作直接移到 master 分支上，需要在bugFix分支上执行<code>git rebase master</code><br />
现在 bugFix 分支上的工作在 master 的最顶端，但master还没有更新，这是需要 checkout到master然后</p>
<p>git rebase bugfix</p>
<p>【git pull 和 git pull --rebase区别】<br />
git pull = git fetch + git merge merge会产生一次提交记录<br />
git pull --rebase = git fetch + git rebase<br />
大多数时候，使用 git pull --rebase 是为了使提交线图更好看，从而方便 code review</p>
<p>【git rebase冲突时】<br />
在source tree中找到冲突文件修改并点解决</p>
<p>【交互式的 rebase】<br />
交互式 rebase 指的是使用带参数 --interactive 的 rebase 命令, 简写为 -i</p>
<p>比如：git rebase -i HEAD~4 可以对HEAD前4个节点之后的提交记录进行重新排序</p>
<p>【在提交树上移动】<br />
HEAD是checkout的灵魂</p>
<p>我们在切换分支，和新建分支的时候（创建分支是从HEAD处创建），有没有想过，这些操作操作背后的工作原理是怎样的呢？最大的功臣就是.git目录下的HEAD引用(可以把它想象成一个指针，指向某个分支或提交记录)。<br />
HEAD 总是指向当前分支上最近一次提交记录，比如：当前在master的工作，则HEAD指向的是当前分支名master，而master又指向了当前的最新的一次提交ID</p>
<p>让HEAD指向某次提交：git checkout <提交号><br />
【相对引用】<br />
指定提交记录哈希值的方式在 Git 中移动不太方便，所以 Git 引入了相对引用，使用相对引用的话，你就可以从一个易于记忆的地方（比如 bugFix 分支或 HEAD）开始计算</p>
<p>使用 ^ 向上移动 1 个提交记录<br />
使用 ~<num> 向上移动多个提交记录，如 ~3<br />
比如：git checkout master^ 把HEAD移动到master的父节点上<br />
【强制修改分支位置】<br />
使用相对引用最多的就是移动分支。可以直接使用 -f 选项让分支指向另一个提交。例如:<br />
git branch -f master HEAD~3<br />
上面的命令会将 master 分支强制指向 HEAD 的第 3 级父提交</p>
<p>【撤销变更】<br />
git reset 通过把分支记录回退几个提交记录来实现撤销改动。你可以将这想象成“改写历史”。<br />
虽然在你的本地分支中使用 git reset 很方便，但是这种“改写历史”的方法对大家一起使用的远程分支是无效的哦！<br />
为了撤销更改并分享给别人，我们需要使用 git revert。比如：git revert HEAD</p>
<p>【整理提交记录】<br />
git cherry-pick <提交号>... 后面可以跟多个提交号</p>
<p>要在心里牢记 cherry-pick 可以将提交树上任何地方的提交记录取过来追加到 HEAD 上（只要不是 HEAD 上游的提交就没问题）。</p>
<p>【Git Describe】</p>
<p>git describe <ref></p>
<p><ref> 可以是任何能被 Git 识别成提交记录的引用，如果你没有指定的话，Git 会以你目前所检出的位（HEAD）。<br />
它输出的结果是这样的：<br />
<tag>_<numCommits>_g<hash></p>
<p>【commit的错了，不想push了】<br />
git reset --hard HEAD^ ^^上两个 HEAD~100 上100个</p>
<p>【cherry-pick 合并特定commits 到另一个分支】<br />
比如，feature 分支上的commit 62ecb3很重要，需要合并到主干<br />
git checkout master<br />
git cherry-pick 62ecb3</p>
<p>【忽略文件】<br />
git 建忽略文件 在目录中建.gitignore文件，并写好规则</p>
<p>【git stash】<br />
git stash 存储当前工作目录<br />
git stash list 查看之前存储的所有版本列表<br />
git stash pop [stash_id] git stash pop stash@{0} 恢复具体某一次的版本,如果不指定stash_id，则默认恢复最新的存储进度<br />
git stash drop [stash_id] git stash drop stash@{5} 删除一个存储的进度。如果不指定stash_id，则默认删除最新的存储进度。<br />
git stash clear 清除所有的存储进度</p>
<p>【git fetch】<br />
git在本地会保存两个版本的仓库，分为本地仓库和远程仓库。<br />
1、本地仓库就是我们平时 add、commit 的那个仓库。<br />
2、远程仓库可以用git remote -v查看（这里的远程仓库是保存在本地的远程仓库，等同于另一个版本，不是远程的远程仓库）。</p>
<p>说说 fetch 和 pull 的不同:</p>
<p>fetch 只能更新远程仓库的代码为最新的，本地仓库的代码还未被更新，我们需要通过 git merge origin/master 来合并这两个版本，你可以把它理解为合并分支一样的。</p>
<p>【不提交某个文件】</p>
<h1 id="执行命令将debug_dofile.lua加入不提交队列">执行命令将debug_dofile.lua加入不提交队列</h1>
<p>git update-index --assume-unchanged debug_dofile.lua</p>
<h1 id="执行命令将debug_dofile.lua取消加入不提交队列">执行命令将debug_dofile.lua取消加入不提交队列</h1>
<p>git update-index --no-assume-unchanged debug_dofile.lua</p>
<p>【git回复删除分支】<br />
查看所有的引用变动的日志 git reflog<br />
找到对应的提交记录 git checkout 6c4a469<br />
git checkout -b save</p>
<p>【Git Submodule】<br />
项目中经常会使用到第三方的 git 库, 将三方库整合到项目中最简单的办法就是复制粘贴<br />
也可以使用git-submodule 操作, 直接把第三方的版本库合并到自己的库中.<br />
涉及的配置文件：.gitmodules .git/config<br />
git submodule update --init --recursive #更新第三方源码</p>
<p>把其他git工程作为Submodule<br />
git submodule add git@gitlab1.minervagame.com:gm/gm-doc.git doc</p>
<p>[core]<br />
repositoryformatversion = 0<br />
filemode = false<br />
bare = false<br />
logallrefupdates = true<br />
symlinks = false<br />
ignorecase = true<br />
autocrlf = false</p>
<p>【命令别名】<br />
Git 的命令含义明确，但缺点是单词太长，多次操作输入就显得很繁琐，这点就不如 SVN<br />
命令那么简单明了。好在我们可以在 Git 的配置文件“.gitconfig”里为这些命令起别名，<br />
比如把“status”改成“st”，把“commit”改成“ci”。<br />
下面这个就是我常用的一个 Git 配置，里面还有个特别的地方是在“diff”的时候使<br />
用“vimdiff”，用可视化的方式来比较文件的差异，比原始的“diff”更好。</p>
<pre><code>[alias]
st = status
ci = commit
br = branch
co = checkout
au = add -u .
ll = log --oneline --graph
d = difftool
[diff]
tool = vimdiff</code></pre>
<p>【设置filemode，文件权限变更引起的修改】</p>
<pre><code>git config --global core.filemode false</code></pre>
<p>【gitdiff】<br />
git diff HEAD 显示工作目录与git 仓库之间的差异；<br />
设置git diff有颜色</p>
<pre><code>git config --global color.ui true</code></pre>

<footer id="colophon" >
		<div class="site-info col">
			Powered by <a href="https://github.com/sunxvming/my-blog">my-blog</a>
			<span class="sep"> | </span>
				<span><a target="_blank" href="http://beian.miit.gov.cn">【京ICP备19018538号】</a></span>
			<span><a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010502037753">【京公网安备 11010502037753号】</a></span>
		</div><!-- .site-info col -->
        <div class="site-info col"> This page is hosted at <a target="_blank" href="https://github.com/sunxvming">Github</a>.To see the source code you can visit the <a target="_blank" href="https://github.com/sunxvming/my-blog">repo</a> and I'd be glad if you like and star it.</div>
</footer>
</div> <!--wrapper-->
</body>
</html>
