<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta name="generator" content="pandoc" />




<link rel="stylesheet" href="../../../.././css/style.css" />




<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Saira+Semi+Condensed%3A400%2C700&ver=4.9.18" type="text/css" />

<script src="https://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
<script>
jQuery(document).ready(function(){
    jQuery('pre').each(function(){
        var el = jQuery(this).find('code');
        var code_block = el.html(); 
 
        if (el.length > 0) { 
            jQuery(this).addClass('prettyprint').html(code_block).attr('style', 'max-height:450px');
        } else { 
            jQuery(this).removeClass().addClass('prettyprint'); 
        }
    });
});
</script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js?skin=desert"></script>

</head>


<body>
<div id="wrapper">


<style type="text/css">

#masthead .site-branding {
    margin-bottom: 7px;
}

#masthead .site-branding .site-title {
    font-size: 2.2rem;
    line-height: 1;
    text-transform: uppercase;
    margin: 0;
    margin-bottom: 0.5rem;
}


#masthead .site-description{
	margin:0px;
}




#masthead .site-branding .site-title a {
    display: inline-block;
    position: relative;
    top: -11px;
}

#masthead  a {
    <!-- color: #007bff; -->
    text-decoration: none;
    background-color: transparent;
}



.io-menu-desktop {
    display: block;
    text-align: right;
}
.io-menu-desktop span.io-menu-button-span {
    display: none;
}
.io-menu-desktop ul {
    padding: 0;
    margin: 0;
    list-style: none;
    background: transparent;
    display: block;
}
.io-menu-desktop ul > li {
    margin-right: -4px;
    display: inline-block;
    position: relative;
    height: 30px;
    color: #212529;
    font-size: 12px;
    text-transform: uppercase;
    text-shadow: 0 0 0 rgb(0 0 0 / 0%);
    font-weight: 400;
}
.io-menu-desktop ul > li > a {
    padding: 0;
    line-height: 29px;
    padding-left: 20px;
    padding-right: 20px;
    padding-top: 1px;
    color: #212529;
    font-size: 12px;
    text-transform: uppercase;
    text-shadow: 0 0 0 rgb(0 0 0 / 0%);
    font-weight: 400;
}
.io-menu-desktop a {
    display: block;
    -o-transition: none;
    -moz-transition: none;
    -webkit-transition: none;
    transition: none;
}
.io-menu-desktop > ul > li.current-menu-item > a, .io-menu-desktop > div > ul > li.current-menu-item > a {
    background: rgba(0, 0, 0, 0.01);
}



#colophon {
    margin-top: 70px;
    margin-bottom: 30px;
}
#colophon .site-info {
    text-align: center;
}

</style>


<header id="masthead" class="site-header row">
    <div class="site-branding col-sm-6">
        <span class="site-title" style="font-size: 2.2rem">
            <span>
                <img width="60px" height="60px"
                    src="http://www.sunxvming.com/imgs/QQ图片20191023170517.jpg">
            </span>


            <a href="http://www.sunxvming.com/" rel="home">忧郁的大能猫</a>
        </span>
        <p class="site-description">好奇的探索者，理性的思考者，踏实的行动者。</p>
    </div><!-- .site-branding -->

    <nav id="site-navigation" class="main-navigation col-sm-9">
        <div class="io-menu io-menu-desktop"><span class="io-menu-button io-menu-button-span">≡</span>

            <div class="menu-%e4%b8%bb%e8%8f%9c%e5%8d%95-container">
                <ul id="primary-menu" class="menu">
                    <li id="menu-item-38"
                        class="menu-item menu-item-type-custom menu-item-object-custom current-menu-item current_page_item menu-item-home menu-item-38">
                        <a href="http://www.sunxvming.com">首页</a></li>
                    <li id="menu-item-175"
                        class="menu-item menu-item-type-post_type menu-item-object-page menu-item-175"><a
                            href="http://www.sunxvming.com/">所有文章</a></li>
                    <li id="menu-item-176"
                        class="menu-item menu-item-type-post_type menu-item-object-page menu-item-176"><a
                            href="http://www.sunxvming.com/blog/about-me.html">关于俺</a></li>
                </ul>
            </div>
        </div><!-- .io-menu -->
    </nav><!-- #site-navigation -->
</header>

<div id="header">
<h1 class="title">blog/IT/c.c++/c++笔记/极客时间-现代C++实战30讲</h1>
</div> <!--id="header"-->
 <!--if(title)-->

<p>Table of Contents:</p>
<div id="TOC">
<ul>
<li><a href="#开篇词-c这么难为什么我们还要用c"> 开篇词 | C++这么难，为什么我们还要用C++？</a></li>
<li><a href="#课前必读-有关术语发音及环境要求"> 课前必读 | 有关术语发音及环境要求</a></li>
<li><a href="#堆栈raiic里该如何管理资源"> 01 | 堆、栈、RAII：C++里该如何管理资源？</a>
<ul>
<li><a href="#堆"> 堆</a></li>
<li><a href="#栈"> 栈</a></li>
<li><a href="#raii"> RAII</a></li>
</ul></li>
<li><a href="#自己动手实现c的智能指针"> 02 | 自己动手，实现C++的智能指针</a></li>
<li><a href="#右值和移动究竟解决了什么问题"> 03 | 右值和移动究竟解决了什么问题？</a></li>
<li><a href="#容器汇编-i比较简单的若干容器"> 04 | 容器汇编 I：比较简单的若干容器</a></li>
<li><a href="#异常用还是不用这是个问题"> 06 | 异常：用还是不用，这是个问题</a></li>
</ul>
</div>
 <!--if(toc)-->

<h2 id="开篇词-c这么难为什么我们还要用c"> 开篇词 | C++这么难，为什么我们还要用C++？</h2>
<p>C++ 的国际标准有 6 个版本，98, 03, 11, 14, 17，20 。<br />
C++03是在C++98上面进行了小幅度的修订，C++11则是一次全面的大进化。<br />
C++11—之后，C++ 以每三年一版的频度发布着新的语言标准。<br />
C++ 是一门多范式的通用编程语言，这些不同的范式，都可以在同一项目中组合使用，这就大大增加了开发的灵活性。因此，C++ 适用的领域非常广泛，小到嵌入式，大到分布式服务器，到处可以见到 C++ 的身影。</p>
<p>C++ 的核心竞争力：<br />
<em> 抽象能力：意味着较高的开发效率，同时，更重要的是，不会因抽象而降低性能。<br />
</em> 性能：这不用多说了，就是快并且占用资源少。<br />
<em> 功耗：这是近年来我们越来越关注的问题，跟性能直接相关，性能好了功耗自然就低。移动设备上。<br />
</em> 和 C 的兼容性，也是 C++ 的一大优势<br />
目前，跟 C++ 定位差不多、能有直接竞争关系的，也就是既支持高度抽象、又追求高性能<br />
的通用编程语言，其实只有 Rust 一种。<br />
我的个人经验，完成同样的功能，C++ 需要的代码行数一般是 Python 的三倍左右，而性能则可以达到<br />
Python 的十倍以上。<br />
当你的软件属于运算密集或者内存密集型，你需要性能、且愿意为性能付出额外代<br />
价的时候，应该考虑用 C++，特别在你的代码需要部署在多台服务器或者移动设备的场<br />
合。反之，如果性能不会成为你开发的软件的瓶颈，那 C++ 可能就不是一个最合适的工<br />
具。</p>
<h2 id="课前必读-有关术语发音及环境要求"> 课前必读 | 有关术语发音及环境要求</h2>
<p>对于 CentOS 7，系统安装的 GCC 版本是 4.8，太老，你可以通过安装 centos-<br />
release-scl 和 devtoolset-7-gcc-c++ 两个包来获得 GCC 7；随后，可以使用命令 scl<br />
enable devtoolset-7 bash 或 . /opt/rh/devtoolset-7/enable 来启用 GCC7</p>
<p>即使不用较新的 C++ 特性，你也一定要用比较新的编译器。单单是输出错误信息的<br />
友好程度，老版本和新版本就是没法比的。</p>
<h2 id="堆栈raiic里该如何管理资源"> 01 | 堆、栈、RAII：C++里该如何管理资源？</h2>
<p>RAII，完整的英文是 Resource Acquisition Is Initialization，是 C++ 所特有的资源管理<br />
方式。有少量其他语言，如 D、Ada 和 Rust 也采纳了 RAII。<br />
RAII 依托栈和析构函数，来对所有的资源——包括堆内存在内——进行管理。对 RAII 的<br />
使用，使得 C++ 不需要类似于 Java 那样的垃圾收集方法，也能有效地对内存进行管理。<br />
RAII 的存在，也是垃圾收集虽然理论上可以在 C++ 使用，但从来没有真正流行过的主要原因。</p>
<h3 id="堆"> 堆</h3>
<p>序通常需要牵涉到三个可能的内存管理器的操作：<br />
1. 让内存管理器分配一个某个大小的内存块 <br />
2. 让内存管理器释放一个之前分配的内存块 <br />
3. 让内存管理器进行垃圾收集操作，寻找不再使用的内存块并予以释放 <br />
C++ 通常会做上面的操作 1 和 2。Java 会做上面的操作 1 和 3。而 Python 会做上面的操<br />
作 1、2、3。这是语言的特性和实现方式决定的。<br />
例子：</p>
<pre><code>void foo()
{
bar* ptr = new bar();
…
delete ptr;
}</code></pre>
<p>存在两个问题：<br />
1.省略的代码部分也许会抛出异常，导致最后的 delete ptr 得不到执行。<br />
2.更重要的，这个代码不符合 C++ 的惯用法。在 C++ 里，这种情况下有 99% 的可能性<br />
不应该使用堆内存分配，而应使用栈内存分配。这样写代码的，估计可能是从 Java 转过<br />
来的（偷笑）——但我真见过这样的代码</p>
<h3 id="栈"> 栈</h3>
<p>栈上的分配极为简单，移动一下栈指针而已。<br />
栈上的释放也极为简单，函数执行结束时移动一下栈指针即可。<br />
由于后进先出的执行过程，不可能出现内存碎片。</p>
<p>编译器会自动调用析构函数，包括在函数执行发生异常的情况。在发生<br />
异常时对析构函数的调用，还有一个专门的术语，叫栈展开（stack unwinding）。</p>
<h3 id="raii"> RAII</h3>
<p>C++ 支持将对象存储在栈上面。但是，在很多情况下，对象不能，或不应该，存储在栈上。比如：<br />
对象很大；<br />
对象的大小在编译时不能确定；<br />
对象是函数的返回值，但由于特殊的原因，不应使用对象的值返回。</p>
<h2 id="自己动手实现c的智能指针"> 02 | 自己动手，实现C++的智能指针</h2>
<p>智能指针本质上并不神秘，其实就是 RAII 资源管理功能的自然展现而已。</p>
<pre><code>class shape_wrapper {
public:
explicit shape_wrapper(
shape* ptr = nullptr)
: ptr_(ptr) {}
~shape_wrapper()
{
delete ptr_;
}
shape* get() const { return ptr_; }
private:
    shape* ptr_;
};</code></pre>
<p>这个类可以完成智能指针的最基本的功能：对超出作用域的对象进行释放。但它缺了点东西：<br />
1.只适用于 shape 类 <br />
2. 该类对象的行为不够像指针 <br />
3. 拷贝该类对象会引发程序行为异常 </p>
<p>上面给出的语义本质上就是 C++98 的 auto_ptr 的定义。如果你觉得这个实现很别扭的 <br />
话，也恭喜你，因为 C++ 委员会也是这么觉得的：auto_ptr 在 C++17 时已经被正式从 <br />
C++ 标准里删除了。</p>
<h2 id="右值和移动究竟解决了什么问题"> 03 | 右值和移动究竟解决了什么问题？</h2>
<pre><code>class A {
B b_;
C c_;
};</code></pre>
<p>从实际内存布局的角度，很多语言——如 Java 和 Python——会在 A 对象里放 B 和 C 的<br />
指针（虽然这些语言里本身没有指针的概念）。而 C++ 则会直接把 B 和 C 对象放在 A 的<br />
内存空间里。这种行为既是优点也是缺点。说它是优点，是因为它保证了内存访问的局域<br />
性，而局域性在现代处理器架构上是绝对具有性能优势的。说它是缺点，是因为复制对象的<br />
开销大大增加：在 Java 类语言里复制的是指针，在 C++ 里是完整的对象。这就是为什么<br />
C++ 需要移动语义这一优化，而 Java 类语言里则根本不需要这个概念。</p>
<p>所有的现代 C++ 的标准容器都针对移动进行了优化。</p>
<h2 id="容器汇编-i比较简单的若干容器"> 04 | 容器汇编 I：比较简单的若干容器</h2>
<h2 id="异常用还是不用这是个问题"> 06 | 异常：用还是不用，这是个问题</h2>

<footer id="colophon" >
		<div class="site-info col">
			Powered by <a href="https://github.com/sunxvming/my-blog">my-blog</a>
			<span class="sep"> | </span>
				<span><a target="_blank" href="http://beian.miit.gov.cn">【京ICP备19018538号】</a></span>
			<span><a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010502037753">【京公网安备 11010502037753号】</a></span>
		</div><!-- .site-info col -->
        <div class="site-info col"> This page is hosted at <a target="_blank" href="https://github.com/sunxvming">Github</a>.To see the source code you can visit the <a target="_blank" href="https://github.com/sunxvming/my-blog">repo</a> and I'd be glad if you like and star it.</div>
</footer>
</div> <!--wrapper-->
</body>
</html>
